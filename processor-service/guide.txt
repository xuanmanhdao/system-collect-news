ğŸ’¡ ÄÃ¢y lÃ  cÃ¡ch thá»§ cÃ´ng Ä‘á»ƒ cháº¡y má»™t file Spark Python (.py) bÃªn trong container Spark, sá»­ dá»¥ng thÃªm gÃ³i phá»¥ trá»£ Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u Kafka.

ğŸ” Giáº£i thÃ­ch tá»«ng dÃ²ng:
ğŸ”¹ docker exec -it spark bash
docker exec: cháº¡y lá»‡nh trong má»™t container Ä‘ang cháº¡y
-it: báº­t cháº¿ Ä‘á»™ tÆ°Æ¡ng tÃ¡c (interactive + tty)
spark: lÃ  tÃªn container báº¡n chá»‰ Ä‘á»‹nh (Ä‘Ã£ Ä‘áº·t trong docker-compose.yml)
bash: má»Ÿ má»™t shell Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c
ğŸŸ° Báº¡n Ä‘ang Ä‘Äƒng nháº­p vÃ o container Spark, giá»‘ng nhÆ° SSH vÃ o 1 server.

ğŸ”¹ cd /opt/spark-apps
Báº¡n chuyá»ƒn vÃ o thÆ° má»¥c chá»©a mÃ£ nguá»“n báº¡n Ä‘Ã£ mount tá»« mÃ¡y host (config á»Ÿ docker-compose.yml):
volumes:
  - ./processor-service:/opt/spark-apps

ğŸ”¹ spark-submit ... spark_news_processor.py
ÄÃ¢y lÃ  lá»‡nh quan trá»ng nháº¥t: cháº¡y má»™t á»©ng dá»¥ng Spark.
Cá»¥ thá»ƒ:
spark-submit \
  --packages org.apache.spark:spark-sql-kafka-0-10_2.12:3.4.3,org.elasticsearch:elasticsearch-spark-30_2.12:8.11.1 \
  spark_news_processor.py
âœ… CÃ¡c pháº§n chÃ­nh:
ThÃ nh pháº§n	Ã nghÄ©a
spark-submit	Lá»‡nh khá»Ÿi cháº¡y job Spark
--packages ...	Tá»± Ä‘á»™ng táº£i thÃªm JAR cáº§n thiáº¿t tá»« Maven
spark-sql-kafka-0-10_2.12	Connector Spark â†” Kafka
kafka-clients	ThÆ° viá»‡n Kafka client (Ä‘á»ƒ gá»­i/nháº­n message)
spark_news_processor.py	Script xá»­ lÃ½ stream tá»« Kafka topic raw-news
ğŸ“Œ Spark sáº½ táº£i JAR nÃ y vÃ o runtime náº¿u chÆ°a cÃ³ vÃ  liÃªn káº¿t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t.